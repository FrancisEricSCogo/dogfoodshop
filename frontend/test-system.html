<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Test - Dog Food Shop</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-item {
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #ddd;
            background: #f9f9f9;
        }
        .test-item.pass {
            border-left-color: #10b981;
            background: #d1fae5;
        }
        .test-item.fail {
            border-left-color: #ef4444;
            background: #fee2e2;
        }
        .test-item.pending {
            border-left-color: #f59e0b;
            background: #fef3c7;
        }
        button {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #4338ca;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        .result.success {
            background: #d1fae5;
            color: #065f46;
        }
        .result.error {
            background: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <h1>üß™ Dog Food Shop - System Test</h1>
    
    <div class="test-container">
        <h2>System Information</h2>
        <div id="systemInfo"></div>
    </div>
    
    <div class="test-container">
        <h2>Quick Tests</h2>
        <button onclick="runAllTests()">Run All Tests</button>
        <button onclick="testDatabase()">Test Database</button>
        <button onclick="testAPI()">Test API</button>
        <button onclick="testLocalStorage()">Test LocalStorage</button>
        <button onclick="testLibraries()">Test Libraries</button>
        <div id="testResults"></div>
    </div>
    
    <div class="test-container">
        <h2>Manual Tests</h2>
        <p><strong>1. Database Connection:</strong> <a href="../api/config/check_database.php" target="_blank">Check Database</a></p>
        <p><strong>2. Login Page:</strong> <a href="../views/guest/login.html" target="_blank">Go to Login</a></p>
        <p><strong>3. Home Page:</strong> <a href="../views/guest/index.html" target="_blank">Go to Home</a></p>
        <p><strong>4. Admin Dashboard:</strong> <a href="../views/admin/dashboard.html" target="_blank">Go to Admin</a></p>
    </div>

    <script>
        const API_BASE = '../backend/api';
        
        function addTestResult(name, status, message) {
            const results = $('#testResults');
            const statusClass = status === 'pass' ? 'pass' : status === 'fail' ? 'fail' : 'pending';
            results.append(`
                <div class="test-item ${statusClass}">
                    <strong>${name}:</strong> ${status.toUpperCase()}
                    <div class="result ${status === 'pass' ? 'success' : 'error'}">${message}</div>
                </div>
            `);
        }
        
        function showSystemInfo() {
            const info = $('#systemInfo');
            info.html(`
                <p><strong>Current URL:</strong> ${window.location.href}</p>
                <p><strong>API Base:</strong> ${API_BASE}</p>
                <p><strong>jQuery:</strong> ${typeof $ !== 'undefined' ? '‚úÖ Loaded' : '‚ùå Not Loaded'}</p>
                <p><strong>SweetAlert:</strong> ${typeof Swal !== 'undefined' ? '‚úÖ Loaded' : '‚ùå Not Loaded'}</p>
                <p><strong>Browser:</strong> ${navigator.userAgent}</p>
            `);
        }
        
        function testDatabase() {
            addTestResult('Database Connection', 'pending', 'Testing...');
            $.ajax({
                url: `${API_BASE}/config/check_database.php`,
                method: 'GET',
                success: function(response) {
                    addTestResult('Database Connection', 'pass', 'Database connection successful!');
                },
                error: function(xhr, status, error) {
                    addTestResult('Database Connection', 'fail', `Error: ${error} - Check if MySQL is running`);
                }
            });
        }
        
        function testAPI() {
            addTestResult('API Endpoints', 'pending', 'Testing products API...');
            $.ajax({
                url: `${API_BASE}/products/get_products.php`,
                method: 'GET',
                success: function(response) {
                    if (response.success) {
                        addTestResult('API Endpoints', 'pass', `Products API working! Found ${response.products.length} products`);
                    } else {
                        addTestResult('API Endpoints', 'fail', 'API returned error: ' + (response.error || 'Unknown'));
                    }
                },
                error: function(xhr, status, error) {
                    addTestResult('API Endpoints', 'fail', `Error: ${error} - Status: ${xhr.status}`);
                }
            });
        }
        
        function testLocalStorage() {
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            
            if (token && user) {
                addTestResult('LocalStorage', 'pass', `Token and user data found. User: ${JSON.parse(user).username || 'N/A'}`);
            } else {
                addTestResult('LocalStorage', 'pass', 'LocalStorage working (no data stored yet - this is normal if not logged in)');
            }
        }
        
        function testLibraries() {
            const tests = [];
            
            if (typeof $ !== 'undefined') {
                tests.push('‚úÖ jQuery loaded');
            } else {
                tests.push('‚ùå jQuery not loaded');
            }
            
            if (typeof Swal !== 'undefined') {
                tests.push('‚úÖ SweetAlert loaded');
            } else {
                tests.push('‚ùå SweetAlert not loaded');
            }
            
            addTestResult('Libraries', tests.every(t => t.includes('‚úÖ')) ? 'pass' : 'fail', tests.join('<br>'));
        }
        
        function runAllTests() {
            $('#testResults').empty();
            showSystemInfo();
            testDatabase();
            setTimeout(() => testAPI(), 500);
            setTimeout(() => testLocalStorage(), 1000);
            setTimeout(() => testLibraries(), 1500);
        }
        
        $(document).ready(function() {
            showSystemInfo();
        });
    </script>
</body>
</html>

